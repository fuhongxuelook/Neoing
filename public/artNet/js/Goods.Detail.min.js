require(["jquery","carousel","bus","common","dotdotdot","lazyload","arttemplate","cvszoom","vue"],function(t,e,i,o,n,a,s,d,r){function c(t,e,i,o){t<0&&(t=10),e<0&&(e=10),console.log(t);var n=i/o,a=t/e,s=[];return n>a?(s[0]=t,s[1]=Math.round(t/n)):(s[1]=e,s[0]=Math.round(e*n)),s}function h(t,e){function i(){0!=t.attr("biaoshifu")&&(clearTimeout(r),n>=3&&(t.find(".imgWidthLine").offset().top<t.find(".widthLine").offset().top?(t.find(".heightLine").hide(),t.find(".widthLine").hide()):(t.find(".heightLine").show(),t.find(".widthLine").show())),t.find(".imgWidthLine").show(),t.find(".imgHeightLine").show(),r=setTimeout(function(){t.find(".heightLine").hide(),t.find(".widthLine").hide(),t.find(".imgWidthLine").hide(),t.find(".imgHeightLine").hide()},3e3))}var o,n;if(inject_data.is_simple_show){$("#topbtns").hide(),t.find("img").css({"-webkit-filter":"none","-moz-filter":"none","-ms-filter":"none",filter:"none"});var a=c(Math.round(u.w*p),Math.round(u.h-400),e.imgW,e.imgH);e.imgShowHeight=common.MathEven(a[1]),e.imgShowWidth=common.MathEven(a[0]),t.find("img").css({height:a[1]+"px",width:a[0]+"px"})}else{!function(t,e){function i(t){return e.imgK*u.h/t<.7*u.w}function a(t){switch(t){case 8:n=i(8)?8:14;break;case 5:n=i(5)?5:i(8)?8:14;break;case 4:n=i(4)?4:i(5)?5:i(8)?8:14;break;case 3:n=i(3)?3:i(4)?4:i(5)?5:i(8)?8:14;break;case 2:n=i(2)?2:i(3)?3:i(4)?4:i(5)?5:i(8)?8:14;break;case 1.5:n=i(1.5)?1.5:i(2)?2:i(3)?3:i(4)?4:i(5)?5:i(8)?8:14;break;case.8:n=i(.8)?.8:i(1.5)?1.5:i(2)?2:i(3)?3:i(4)?4:i(5)?5:i(8)?8:14}}e.imgG>=7?n=14:a(e.imgG>=4?8:e.imgG>=2.4?5:e.imgG>=1.8?4:e.imgG>=1.2?3:e.imgG>=.9?2:e.imgG>=.6?1.5:.8),n<3?u.css("background-image","url('/content/image/WallPaper/wall_bg.jpg')"):u.css("background-image","url('/content/image/WallPaper/detail_bg.jpg')"),o=n*e.imgW/e.imgH,t.find(".heightLine span").text(n.toFixed(1)+"m");var s=parseInt(o*u.height()*p/n),d=s>.78*u.width()?.78*u.width():s;t.find(".widthLine").width(d),t.find(".widthLine span").text((o*d/s).toFixed(1)+"m")}(t,e),i();var s=common.MathEven(Math.round(e.imgG/n*u.height()*p)),d=common.MathEven(Math.round(e.imgW*s/e.imgH));e.imgShowHeight=s,e.imgShowWidth=d,t.find("img").css({height:s,width:d}),t.find(".imgLine.imgWidthLine").css({marginLeft:-d/2+"px",marginTop:-s/2-33+"px"}),t.find(".imgLine.imgHeightLine").css({marginLeft:-d/2-33+"px",marginTop:-s/2+"px"}),t.find(".imgLine.imgWidthLine").css({transition:"width 1s",width:d+"px"}),t.find(".imgLine.imgHeightLine").css({transition:"height 1s",height:s+"px"}),t.find("img").hover(function(){i()})}var r}function l(){$("span[show=chooseframe]").click(),$(".frametip").show()}function m(t){var e=k[t].ImgWidth/k[t].ImgHeight,i=u.h,o=i*e,n=o/k[t].ImgWidth,a=(u.w-o)/2,s=v[0].frameWBL?v[0].frameWBL:1,d=o*inject_data.artworkimgs[0].size_width*s/k[t].SizeWidth;$("#lifescenes .work").css({left:k[t].CenterLeft*n+a,top:k[t].CenterTop*n,width:d+"px"})}function g(t){t=t.replace(/-/g,"/");var e=new Date(t).getTime()-(new Date).getTime(),i=e/1e3,o=(Math.floor(i),e/864e5),n=Math.floor(o),a=24*(o-n);return n+"天"+Math.floor(a)+"小时"}function f(){if(inject_data.is_allow_rebid){var t={module:"Goods.Rebid",action:"GetArtworkRebidInfo",artworkcode:inject_data.artwork_code};$.ajax({data:t}).done(function(t){t.Success?($(".buyagainbox").show(),_=t.Data.ListRebidHistory.length,I=t.Data.NextPrice,y=t.Data.TopPrice,H=t.Data.SurplusTimes,$(".timing span").html(g(t.Data.BidEndTime)),$(".DealTime").html("成交时间："+t.Data.DealTime.substr(0,4)+"."+t.Data.DealTime.substr(5,2)).show(),common.checkLogin2(function(){$(".BAnologin").hide(),$(".BAlogined").show(),$(".BAlogined input").attr("placeholder","最低可出价：¥"+common.fmoney(I)),_>0&&($(".BAlogined .noBA").hide(),$(".BAlogined .hasBA").show(),$(".BAhistorybtn").html("已有"+_+"次出价"),$(".newprice").html(common.fmoney(y)),null!=t.Data.UserLastRecord&&$(".BAhistorynew").html("您已于"+t.Data.UserLastRecord.CreateTime+"出价<br />¥"+common.fmoney(t.Data.UserLastRecord.PriceRebid)).show())},function(){})):$(".buyagainbox").hide()}),$(".BAnologin .buyagainbtn").click(function(){common.checkLogin(function(){var t={module:"Goods.Rebid",action:"GetArtworkRebidInfo",artworkcode:inject_data.artwork_code};$.ajax({data:t}).done(function(t){t.Success?(_=t.Data.ListRebidHistory.length,I=t.Data.NextPrice,y=t.Data.TopPrice,H=t.Data.SurplusTimes,$(".timing span").html(g(t.Data.BidEndTime)),$(".BAnologin").hide(),$(".BAlogined").show(),$(".BAlogined input").attr("placeholder","最低可出价：¥"+common.fmoney(I)),_>0&&($(".BAlogined .noBA").hide(),$(".BAlogined .hasBA").show(),$(".BAhistorybtn").html("已有"+_+"次出价"),$(".newprice").html(common.fmoney(y)),null!=t.Data.UserLastRecord&&$(".BAhistorynew").html("您已于"+t.Data.UserLastRecord.CreateTime+"出价<br />¥"+common.fmoney(t.Data.UserLastRecord.PriceRebid)).show())):($(".buyagainbox").hide(),alert(t.ErrorMsg))})})}),$(".BAlogined .buyagainbtn").click(function(){common.checkLogin(function(){var t=$(".BAlogined .inputandbtn input").val();if(H<=0)return void alert("您今天的出价机会已经用完，请明天再来");t<I?alert("你的出价不能少于"+I+"元！"):t>10*I?alert("你的出价不能大于"+10*I+"元！"):(alert('<div class="BAdialog"><p class="title">您出价 ¥'+common.fmoney(t)+'</p><div class="BAsure">确认出价</div><p class="BAtodaytime">您今天还有'+H+"次出价机会</p></div>"),$(".BAsure").off("click").click(function(){var e={module:"Goods.Rebid",action:"AddRebid",artworkcode:inject_data.artwork_code,price:t};$.ajax({data:e}).done(function(t){t.Success?(alert('<div class="BAdialog"><p class="title"><img src="/Content/image/success.png"> 出价成功</p><p class="info">我们会通知藏家，如有交易意向，艺网会尽快与您取得联系</p><p class="BAtodaytime">您今天还有'+--H+"次出价机会</p></div>"),f()):alert(t.ErrorMsg)})}))})}),$(".BAhistorybtn").click(function(){common.checkLogin(function(){var t={module:"Goods.Rebid",action:"GetArtworkRebidInfo",artworkcode:inject_data.artwork_code};$.ajax({data:t}).done(function(t){if(t.Success){var e='<div style="height:260px;"><table style="width:620px;overflow:auto;text-align:left;font-size:12px;color:#666">';e+='<tr style="height:20px;margin-bottom:10px"><td>时间</td><td>用户</td><td>出价</td></tr>';for(var i=0;i<t.Data.ListRebidHistory.length;i++)e+='<tr style="height:20px;"><td>'+t.Data.ListRebidHistory[i].CreateTime+"</td><td>"+t.Data.ListRebidHistory[i].ShowName+"</td><td>¥"+t.Data.ListRebidHistory[i].PriceRebid+"</td></tr>";e+="</table></div>",alert(e,"出价历史")}else alert(t.ErrorMsg)})})})}}$(window).on("scroll",function(){$(document).scrollTop()<200?$(".scroll_top").fadeIn(200):$(".scroll_top").fadeOut(200)});var u=$("#container"),p=($(".model1"),.83),w=800;inject_data.has_add_wishlist&&$(".like").addClass("active"),inject_data.is_sold&&$(".buyBtn").hide();u.height($(window).height()-68),u.h=u.height(),u.w=u.width();var v=[];!function(t){for(var e=0;e<t.artworkimgs.length;e++)v[e]={src:"https://cdn.ywart.com/yw/"+t.artworkimgs[e].file_name,imgW:t.artworkimgs[e].pixel_width,imgH:t.artworkimgs[e].pixel_height,imgK:t.artworkimgs[e].size_width/100,imgG:t.artworkimgs[e].size_height/100,srcL1:"https://cdn.ywart.com/yw/"+t.artworkimgs[e].file_name+"@"+w+"h_"+w+"w_0e_1l.src"};$("#lifescenes .work").attr("src",v[0].srcL1)}(inject_data),function(){var t=$("#container>.msgowl>.works .work").clone(),e=$("#container>.msgowl>.works");e.html("");for(var i=0;i<v.length;i++)t=t.clone(),t.find("img").attr("src",v[i].srcL1),t.find(".imgWidthLine>span")[0].innerText=v[i].imgK.toFixed(2)+"m",t.find(".imgHeightLine>span")[0].innerText=v[i].imgG.toFixed(2)+"m",h(t,v[i]),e.append(t);v.length>1?($("#container>.msgowl>.works>.work").css({width:$("#container").width()+"px",height:$("#container").height()+"px"}),e.on("initialized.owl.carousel",function(t){var e='<div style="display:inline-block;text-align:center"><span class="curIndex">1</span> ／ '+t.item.count+"</div>";$(this).find(".owl-prev").after(e)}),e.on("translate.owl.carousel",function(t){$(this).find(".curIndex").html(t.item.index+1)}),e.on("custom.framechange",function(t){e.trigger("to.owl.carousel",[0,400,!0])}),e.owlCarousel({items:1,nav:!0,navText:["<img src='/content/image/leftbtn.svg'>","<img src='/content/image/rightbtn.svg'>"],dots:!1})):$(".works.abs100.owl-carousel").show()}(),function(){for(var t=0;t<v.length;t++)!function(t){$.ajax(v[t].src+"@info",{cache:!0,type:"get"}).done(function(e){v[t].imgW=e.width,v[t].imgH=e.height,v[t].size=e.size;var i=function(e){$(window).scrollTop(0);var o,n,a=v[t].imgW,s=v[t].imgH,d=a/s,r=u.w/u.h;d>r?(o=.8*u.w,n=o/d):(n=.8*u.h,o=n*d);var c=this,h=$(c).css("width"),l=$(c).css("height");!function(){var e=splitBlock(v[t].src,{size:v[t].size,height:v[t].imgH,width:v[t].imgW});$("#model2").cvszoom(e).closed=function(){$(c).css({width:h,height:l}),$("#model2").hide(),$(".model1 img:eq("+t+")").one("click",i)}}(),$(c).animate({width:parseInt(h)*o/v[t].imgShowWidth+"px",height:parseInt(l)*n/v[t].imgShowHeight+"px"},400,function(){$("#model2").fadeIn(100)})};$(".model1 img:eq("+t+")").one("click",i)})}(t)}(),$(".topbtn").hover(function(){$(this).hasClass("active")||$("#topbtns").css("background","rgba(255,255,255,.6)")},function(){$(this).hasClass("active")||$("#topbtns").css("background","rgba(255,255,255,.2)")}).click(function(){$(".topbtn").removeClass("active"),$(this).addClass("active"),$("#topbtns").css("background","rgba(255,255,255,.2)")});var b=setTimeout('$(".buyInfo").fadeOut(500);',3e3);$(".buyInfo").on("mouseenter",function(){null!=b&&(clearTimeout(b),b=null),$(".buyInfo").stop().fadeIn(0)}),$(".buyInfoBtn").hover(function(){$(".buyInfo").stop().fadeIn(500),$(".detail").stop().hide()}),$(".artInfoBtn").hover(function(){$(".detail").stop().fadeIn(500),$(".buyInfo").stop().hide()}),$("#container").click(function(){$(".buyInfo:visible").stop().fadeOut(500),$(".detail:visible").stop().fadeOut(500)}),$(".detail").on("click",function(t){t.stopPropagation()}),$(".buyInfo").on("click",function(t){t.stopPropagation()}),$(".detailBox").on("click",function(t){t.stopPropagation()}),$(".buy").click(function(){common.checkLogin(function(){if(inject_data.isZaoYi&&0==L.Id)return void l();if("已售"==$(".buy_div .nosell").text())return void alert("对不起，此作品已售，请选择其他艺术品！");var t={};t.module="Shopping.Cart",t.action="CheckoutCart";var e={};e.ArtworkCode=inject_data.artwork_code,e.EditionId=$("#mychoie").attr("data-editionid"),""!=inject_data.agent_code&&(e.AgentCode=inject_data.agent_code),$("#isNeedFrame").length&&$("#isNeedFrame")[0].checked&&(e.FrameId=L.Id,e.PaddingId=M.Id,console.log(e.FrameId,e.PaddingId)),t.ArtworkWithEditionList=JSON.stringify([e]),$.ajax({data:t}).done(function(t){if(t.Success){var e=t.Data;""!=inject_data.agent_code?bus.tools.gotoUrl("/shopping/order/"+e+"?agentcode="+inject_data.agent_code):bus.tools.gotoUrl("/shopping/order/"+e)}else alert(t.ErrorMsg)})})}),$(".cart").click(function(){$(this);common.checkLogin(function(){if(inject_data.isZaoYi&&0==L.Id)return void l();if("已售"==$(".buy_div .nosell").text())return void alert("对不起，此作品已售，请选择其他艺术品！");var t={};t.module="Shopping.Cart",t.action="AddCartItem",""!=inject_data.agent_code&&(t.AgentCode=inject_data.agent_code),t.artwork_code=inject_data.artwork_code,t.editionid=$("#mychoie").attr("data-editionid"),$("#isNeedFrame").length&&$("#isNeedFrame")[0].checked&&(t.frameId=L.Id,t.paddingId=M.Id),t.count=1,$.ajax({data:t}).done(function(t){t.Success?alert("已添加至购物车","提示",2):alert(t.ErrorMsg)})})}),$(".like").click(function(){$(this);common.checkLogin(function(){common.like(inject_data.artwork_code,function(t){t.Success&&(1==t.Data?$(".like").addClass("active"):$(".like").removeClass("active"))},!$(".like").hasClass("active"))})});var B=$(".workHeader>span");$(B[0]).click(function(){$(".workDes").show(),$(".workInf").hide(),$(".workHeader>span").removeClass("spanActive"),$(this).addClass("spanActive")}),$(B[1]).click(function(){$(".workDes").hide(),$(".workInf").show(),$(".workHeader>span").removeClass("spanActive"),$(this).addClass("spanActive")}),$(".cansell").click(function(){$(".cansell.active").removeClass("active"),$(this).addClass("active"),$("#mychoie").html($(this).html()).attr("data-editionid",$(this).attr("data-editionid"))}),$("#bc_leftbtn").click(function(){var t=$("#bc_pageserial").html();"1"!=t&&($(".bc_table_content div").eq(t-1).animate({"margin-left":"320px"},300),t--,$(".bc_table_content div").eq(t-1).animate({"margin-left":"0"},300),$("#bc_pageserial").html(t))}),$("#bc_rightbtn").click(function(){var t=$("#bc_pageserial").html(),e=$(".bc_table_content div");t!=e.length&&(e.eq(t-1).animate({"margin-left":"-320px"},500),t++,e.eq(t-1).animate({"margin-left":"0"},500),$("#bc_pageserial").html(t))}),$("img.lazy").lazyload({threshold:300,failurelimit:2}),setTimeout(function(){$(".anotherWorks img").each(function(t){var e=this;$.ajax($(e).attr("data-original").split("_")[0]+"@info",{cache:!0,type:"get"}).done(function(t){$(e).css("width",260*t.width/t.height+"px")})})},2e3);var x=inject_data.list_scene.length,k=inject_data.list_scene,A=0;!function(){x<1||inject_data.is_simple_show||($("#topbtns").show(),$("#shcj").one("click",function(t){function e(t){A=t,$("body")[0].scrollTop>10&&$("body").stop().animate({scrollTop:0},400),$("#lifescenes").css("background-image","url(https://cdn.ywart.com/scenebg/"+k[t].FileName+"@90Q)"),m(t)}$("#lifescenes").show(),$(".msgowl").hide(),$("#MEIQIA-BTN-HOLDER").hide();var i=$(".morescenes .img").clone(),o=$("#lifescenes .owl-carouselbox");o.html("");for(var n=0;n<x;n++)i=i.clone(),i.find("img").data("imgid",n).attr("src","https://cdn.ywart.com/scenebg/"+k[n].FileName+"@1e_0o_0l_160h_200w_100q.src"),o.append(i);x>1?o.owlCarousel({autoWidth:!0,nav:!0,navText:["<i class='fa fa-angle-left'></i>","<i class='fa fa-angle-right'></i>"],dots:!1,onInitialized:function(){o.find(".owl-stage").width(2*o.find(".owl-stage").width())}}):$(".morescenes").hide(),e(0),$(".morescenes img").on("click",function(){e($(this).data("imgid"))}),$("#shcj").on("click",function(t){$("#lifescenes").show(),$(".msgowl").hide(),document.onscroll=function(t){document.body.scrollTop>200?$("#MEIQIA-BTN-HOLDER").show():$("#MEIQIA-BTN-HOLDER").hide()}}),$("#msg").on("click",function(t){$("#lifescenes").hide(),$(".msgowl").show(),$("#MEIQIA-BTN-HOLDER").show(),document.onscroll=null}),$(document).on("keydown",function(t){if($("#lifescenes").is(":hidden"))return!0;switch(t.keyCode){case 37:A--,A<0&&(A=x-1);break;case 39:A++,A>=x&&(A=0);break;default:return!0}return e(A),!0});var a;if($(".morescenes").hover(function(){clearTimeout(a),$(this).css("bottom","0")},function(){a=setTimeout(function(){$(".morescenes").css("bottom","-132px")},3e3)}),$("#lifescenes").click(function(t){t.target!=$("#lifescenes")[0]&&t.target!=$("#lifescenes .work")[0]||$(".morescenes").css("bottom","-132px")}),function(t){t.onmousedown=function(e){var e=e||event,i=e.clientX-t.offsetLeft,o=e.clientY-t.offsetTop;return navigator.userAgent.indexOf("Safari")>-1&&-1==navigator.userAgent.indexOf("Chrome")&&$(t).css({"-webkit-filter":"none","-moz-filter":"none","-ms-filter":"none",filter:"none"}),document.onmousemove=function(e){var e=e||event,n=e.clientX-i,a=e.clientY-o;n<t.offsetWidth/2&&(n=t.offsetWidth/2),n>document.documentElement.clientWidth-t.offsetWidth/2&&(n=document.documentElement.clientWidth-t.offsetWidth/2),a<t.offsetHeight/2&&(a=t.offsetHeight/2),a>document.documentElement.clientHeight-t.offsetHeight/2-68&&(a=document.documentElement.clientHeight-t.offsetHeight/2-68),t.style.left=n+"px",t.style.top=a+"px"},document.onmouseup=function(){document.onmousemove=document.onmouseup=null,navigator.userAgent.indexOf("Safari")>-1&&-1==navigator.userAgent.indexOf("Chrome")&&$(t).css({"-webkit-filter":"drop-shadow(0 6px 4px rgba(0,0,0,.6))","-moz-filter":"drop-shadow(0 6px 4px rgba(0,0,0,.6))","-ms-filter":"drop-shadow(0 6px 4px rgba(0,0,0,.6))",filter:"drop-shadow(0 6px 4px rgba(0,0,0,.6))"})},!1}}($("#lifescenes .work")[0]),0!=$("#topbtns:visible").length){var s=0,d=0;setInterval(function(){0==s?d++:d=0,d>9&&$("#topbtns").stop().fadeOut(300),s=0},200),u.on("mousemove",function(){s=1,$("#topbtns").stop().fadeIn(400)})}}))}(),function(){function t(){for(var t=0;t<$(".comment_box:visible .replycontent:visible").length;t++){var e=null;$(".comment_box:visible .replycontent:visible").eq(t).trigger("isTruncated",function(t){e=t,t&&$(this).one("click",function(){$(this).css({maxHeight:"none",height:"auto",cursor:"auto"}),$(this).trigger("originalContent.dot",function(t){$(this).trigger("destory.dot"),$(this).html("").append(t),$(this).html($(this).html())})})}),1!=e&&($(".comment_box:visible .replycontent:visible").eq(t).dotdotdot({wrap:"letter"}),$(".comment_box:visible .replycontent:visible").eq(t).trigger("isTruncated",function(t){e=t,t&&$(this).one("click",function(){$(this).css({maxHeight:"none",height:"auto",cursor:"auto"}),$(this).trigger("originalContent.dot",function(t){$(this).trigger("destory.dot"),$(this).html("").append(t),$(this).html($(this).html())})})}))}}function e(t,e,i,o){common.checkLogin(function(){var n={module:"Common.Comment",action:"AddComment",artworkCode:inject_data.artwork_code,content:t};-1!=e&&(n.pid=e),$.ajax({data:n}).done(function(t){t.Success?i(t.Data):t.ErrorMsg&&alert(t.ErrorMsg),o&&o(t)})})}function i(t,e,i){common.checkLogin(function(){var o={module:"Common.Comment",action:"CommentLike",id:t,commentaction:e?1:2};$.ajax({data:o}).done(function(t){t.Success?i(t.Data):alert(t.ErrorMsg)})})}function o(t,e){var i={module:"Common.Comment",action:"GetCommentList",artworkCode:inject_data.artwork_code,lastId:0,pageSize:30};-1!=t&&(i.pid=t),$.ajax({data:i}).done(function(t){t.Success?(e(t.Data),console.log(t.Data)):alert(t.ErrorMsg)})}o(-1,function(n){window.vm=new r({el:"#commentsection",data:{commentContent:"",items:n.length>3?n.slice(0,3):n,block:"block",itemsAll:n,isshowall:!1,isnotShowAllreply:[]},methods:{AddComment:function(t,i){var n=this,a=event.target;a.disabled=!0;var s=$(a).siblings("textarea"),d=s.val();if($.trim(d).length<4)return alert("评论内容不能少于4个字符"),void(a.disabled=!1);e(d,t,function(){o(t,function(e){-1==t?n.isshowall?(n.items=e,n.itemsAll=e):(n.items=e.length>3?e.slice(0,3):e,n.itemsAll=e):(n.items[i].ChildItem=e,n.itemsAll[i].ChildItem=e)})},function(){s.val(""),a.disabled=!1})},CommentLike:function(t,e,o){var n=this;i(t,e,function(t){e?n.items[o].CountLike=t:n.items[o].CountDislike=t})},ShowReplyBox:function(){$(event.target).parents(".bottomtools").siblings(".reply").slideToggle().find("textarea").val("@"+$(event.target).parents(".bottomtools").siblings("p.name").html()+" ")},showAllComment:function(){this.isshowall=!0,this.items=this.itemsAll,$(".morecomment").hide()},showAllReply:function(t,e){var i=this;$("#"+t).find(".reply_box").removeClass("_hidden"),$("#"+t).find(".morereply").hide(),this.isnotShowAllreply[e]=!0,o(t,function(t){i.items[e].ChildItem=t,i.itemsAll[e].ChildItem=t})}},updated:function(){t()},mounted:function(){t()}})})}();var _=0,y=0,I=0,H=0;f();var L={index:-1,Id:0,Name:"无框"},M={index:-1,Id:0,Name:"无卡纸"};inject_data.isOnlyOneFrameAndPadding&&(L={index:1,Id:inject_data.list_frame[0].ArtworkFrame.Id,Name:inject_data.list_frame[0].ArtworkFrame.Name},M={index:1,Id:inject_data.list_frame[0].Paddings[0].Id,Name:inject_data.list_frame[0].Paddings[0].Name},setTimeout(function(){$(".framestylebox span").eq(1).addClass("active").siblings().removeClass("active"),$(".paddingstylebox span").eq(1).addClass("active").siblings().removeClass("active")},200)),function(){function t(){$(".paddingstylebox span").click(function(){if(!$(this).hasClass("active")&&-1!=L.index){if("无卡纸"==$(this).text())M.index=-1,M.Id=0,M.Name="无卡纸",i(L,M);else{$(".frametip").hide();var t=$(this).data("i"),e=n[L.index].Paddings[t];$.extend(M,e),M.src="https://cdn.ywart.com/artwork_frame/padding/"+e.SampleImg,M.index=t,i(L,M)}$(".paddingstylebox span").removeClass("active"),$("."+this.className).addClass("active"),$(".msgowl .work").attr("biaoshifu",0),$(".staff").hide(),o()}})}function e(t,e,i){$("#container>.msgowl>.works").trigger("custom.framechange"),$(".imgScale img").eq(0).attr("src",t).css({height:"auto",width:common.MathEven(Math.round(e))+"px"}),$("#lifescenes .work").attr("src",t),v[0].frameWBL=i,m(A)}function i(t,i){function o(){var i=new Image;i.onload=function(){var i=Math.round(t.A1Width*m),o=Math.round(t.A1Height*m),c=Math.round(t.A2Width*m),l=Math.round(t.A2Height*m),g=Math.round(t.A3Width*m),f=Math.round(t.A3Height*m),u=Math.round(t.A4Width*m),$=Math.round(t.A4Height*m);I.drawImage(this,t.A1Left,t.A1Top,t.A1Width,t.A1Height,0,0,i,o),I.drawImage(this,t.A2Left,t.A2Top,t.A2Width,t.A2Height,a-Math.round(t.A2Width*m),0,c,l),I.drawImage(this,t.A3Left,t.A3Top,t.A3Width,t.A3Height,a-Math.round(t.A3Width*m),s-Math.round(t.A3Height*m),g,f),I.drawImage(this,t.A4Left,t.A4Top,t.A4Width,t.A4Height,0,s-Math.round(t.A4Height*m),u,$),0==t.B1RenderType?I.drawImage(this,t.B1Left,t.B1Top,t.B1Width,t.B1Height,i,0,a-i-c,Math.round(t.B1Height*m)):n(I,this,t.B1Left,t.B1Top,t.B1Width,t.B1Height,i,0,a-i-c,Math.round(t.B1Height*m),1,Math.round(t.B1Width*m)),0==t.B2RenderType?I.drawImage(this,t.B2Left,t.B2Top,t.B2Width,t.B2Height,a-Math.round(t.B2Width*m),l,Math.round(t.B2Width*m),s-l-f):n(I,this,t.B2Left,t.B2Top,t.B2Width,t.B2Height,a-Math.round(t.B2Width*m),l,Math.round(t.B2Width*m),s-l-f,0,Math.round(t.B2Height*m)),0==t.B3RenderType?I.drawImage(this,t.B3Left,t.B3Top,t.B3Width,t.B3Height,u,s-Math.round(t.B3Height*m),a-g-u,Math.round(t.B3Height*m)):n(I,this,t.B3Left,t.B3Top,t.B3Width,t.B3Height,u,s-Math.round(t.B3Height*m),a-g-u,Math.round(t.B3Height*m),1,Math.round(t.B3Width*m)),0==t.B3RenderType?I.drawImage(this,t.B4Left,t.B4Top,t.B4Width,t.B4Height,0,o,Math.round(t.B4Width*m),s-o-$):n(I,this,t.B4Left,t.B4Top,t.B4Width,t.B4Height,0,o,Math.round(t.B4Width*m),s-o-$,0,Math.round(t.B4Height*m)),e(r.toDataURL("image/jpeg"),d.imgShowWidth*a/h[0],a/h[0])},i.crossOrigin="*",i.src=t.src}function n(t,e,i,o,n,a,s,d,r,c,h,l){if(_.clearRect(0,0,A.width,A.height),1==h){y=Math.round(r/l),0==y&&(y=1),A.width=y*l,A.height=c;for(var m=0;m<y;m++)_.drawImage(e,i,o,n,a,l*m,0,l,c)}else{y=Math.round(c/l),0==y&&(y=1),A.height=y*l,A.width=r;for(var m=0;m<y;m++)_.drawImage(e,i,o,n,a,0,l*m,r,l)}t.drawImage(A,0,0,A.width,A.height,s,d,r,c)}var a,s,d=v[0],r=document.createElement("canvas"),h=c(w,w,d.imgW,d.imgH),l=h[0]/d.imgK/100,m=l/t.SampleResolution,g=Math.round((t.B4Width-t.A4CoverX)*m),f=Math.round((t.B2Width-t.A2CoverX)*m),u=Math.round((t.B1Height-t.A1CoverY)*m),$=Math.round((t.B3Height-t.A4CoverY)*m);if(-1!=i.index){var p=l/i.SampleResolution,b=Math.round((i.B4Width-i.A4CoverX)*p),B=Math.round((i.B2Width-i.A2CoverX)*p),x=Math.round((i.B1Height-i.A1CoverY)*p),k=Math.round((i.B3Height-i.A4CoverY)*p);a=h[0]+g+f+b+B,s=h[1]+u+$+x+k}else a=h[0]+g+f,s=h[1]+u+$;r.width=a,r.height=s;var A=document.createElement("canvas"),_=A.getContext("2d"),y=0,I=r.getContext("2d");I.fillStyle="#ffffff",I.fillRect(0,0,a,s);var H=new Image;H.crossOrigin="*",H.onload=function(){if(-1!=i.index){I.drawImage(H,g+b,u+x,h[0],h[1]);var t=new Image;t.onload=function(){var t=Math.round(i.A1Width*p),e=Math.round(i.A1Height*p),d=Math.round(i.A2Width*p),r=Math.round(i.A2Height*p),c=Math.round(i.A3Width*p),h=Math.round(i.A3Height*p),l=Math.round(i.A4Width*p),m=Math.round(i.A4Height*p);I.drawImage(this,i.A1Left,i.A1Top,i.A1Width,i.A1Height,g,u,t,e),I.drawImage(this,i.A2Left,i.A2Top,i.A2Width,i.A2Height,a-f-d,u,d,r),I.drawImage(this,i.A3Left,i.A3Top,i.A3Width,i.A3Height,a-f-c,s-$-h,c,h),I.drawImage(this,i.A4Left,i.A4Top,i.A4Width,i.A4Height,g,s-$-m,l,m),0==i.B1RenderType?I.drawImage(this,i.B1Left,i.B1Top,i.B1Width,i.B1Height,g+t,u,a-t-d-g-f,Math.round(i.B1Height*p)):n(I,this,i.B1Left,i.B1Top,i.B1Width,i.B1Height,g+t,u,a-t-d-g-f,Math.round(i.B1Height*p),1,Math.round(i.B1Width*p)),0==i.B2RenderType?I.drawImage(this,i.B2Left,i.B2Top,i.B2Width,i.B2Height,a-f-Math.round(i.B2Width*p),u+r,Math.round(i.B2Width*p),s-r-h-u-$):n(I,this,i.B2Left,i.B2Top,i.B2Width,i.B2Height,a-f-Math.round(i.B2Width*p),u+r,Math.round(i.B2Width*p),s-r-h-u-$,0,Math.round(i.B2Height*p)),0==i.B3RenderType?I.drawImage(this,i.B3Left,i.B3Top,i.B3Width,i.B3Height,g+l,s-$-Math.round(i.B3Height*p),a-c-l-g-f,Math.round(i.B3Height*p)):n(I,this,i.B3Left,i.B3Top,i.B3Width,i.B3Height,g+l,s-$-Math.round(i.B3Height*p),a-c-l-g-f,Math.round(i.B3Height*p),1,Math.round(i.B3Width*p)),0==i.B4RenderType?I.drawImage(this,i.B4Left,i.B4Top,i.B4Width,i.B4Height,g,u+e,Math.round(i.B4Width*p),s-e-m-u-$):n(I,this,i.B4Left,i.B4Top,i.B4Width,i.B4Height,g,u+e,Math.round(i.B4Width*p),s-e-m-u-$,0,Math.round(i.B4Height*p)),o()},t.crossOrigin="*",t.src=i.src}else I.drawImage(H,g,u,h[0],h[1]),o()},H.src=d.srcL1}function o(t){var e={module:"Goods.Detail",action:"GetArtworkAdditionalFee",artworkcode:inject_data.artwork_code,artworkframeid:L.Id,artworkframepaddingid:M.Id};$.ajax({data:e}).done(function(e){if(e.Success){var i=e.Data.pricemodel.FrameAmount,o=e.Data.pricemodel.ExpressAmount;L.Id>0?(i>0?$(".FrameAmount").show().find("#mount").html("¥"+i+"（"+L.Name+"，"+M.Name+"）"):$(".FrameAmount").show().find("#mount").html("免费（"+L.Name+"，"+M.Name+"）"),$(".FrameAmount input").attr("checked","checked")):$(".FrameAmount").hide(),o>0?$(".ExpressAmount").html("¥"+o):$(".ExpressAmount").html("免费"),t&&t(e.Data)}else alert(e.ErrorMsg)})}var n=inject_data.list_frame;if(inject_data.isZaoYi&&$(".FrameAmount input").attr("disabled",!0),o(),n.length){$("#tabindex").show(),$("#tabindex span[show=chooseframe]").show(),0==$("#banHao").length&&($("#chooseframe").show(),$("#tabindex span[show=chooseframe]").addClass("active")),$(".ls_chooseframe").show();var a=s("tem-framebox",{list:n});if($("#chooseframe .framestylebox").append(a),$(".ls_chooseframe .framestylebox2").append(a),n[0].Paddings.length>0){var d=s("tem-paddingbox",{list:n[0].Paddings});$(".paddingstylebox").append(d)}else $(".paddingstylebox").hide()}if($("#tabindex span").click(function(){$(this).addClass("active").siblings().removeClass("active"),$("#banHao,#chooseframe").hide(),$("#"+$(this).attr("show")).show()}),$("#isNeedFrame").on("click",function(t){0==$("#isNeedFrame")[0].checked?$(".FrameAmount").css("color","#c0c0c0"):$(".FrameAmount").css("color","#666666")}),$(".framestylebox span").click(function(){if(!$(this).hasClass("active")){if("无框"==$(this).text())L={index:-1,Id:0,Name:"无框"},M={index:-1,Id:0,Name:"无卡纸"},$(".paddingstyle").siblings().removeClass("active"),$(".paddingstyle").addClass("active"),e(v[0].srcL1,v[0].imgShowWidth,1),$(".msgowl .work").attr("biaoshifu",1);else{$(".frametip").hide();var a=$(this).data("i"),d=n[a].ArtworkFrame;$.extend(L,d),L.src="https://cdn.ywart.com/artwork_frame/frame/"+d.SampleImg,L.index=a;var r=n[a].Paddings;if(r.length>0){var c=s("tem-paddingbox",{list:r});$(".paddingstylebox").html(c).show(),t();for(var h=!1,l=0;l<r.length;l++)if(r[l].Id==M.Id){$(".paddingstyle").removeClass("active"),$(".paddingstyle"+l).addClass("active"),h=!0;break}h||(M={index:-1,Id:0,Name:"无卡纸"},$(".paddingstyle").addClass("active"))}else $(".paddingstylebox").hide();i(L,M),console.log(L,M),$(".msgowl .work").attr("biaoshifu",0),$(".staff").hide()}$(".framestylebox span").removeClass("active"),$("."+this.className).addClass("active"),o()}}),t(),x>0){var r;$(".ls_chooseframe").hover(function(){clearTimeout(r),$(this).css("right","0")},function(){r=setTimeout(function(){$(".ls_chooseframe").css("right","-100px")},3e3)}),$("#lifescenes").click(function(t){t.target!=$(".ls_chooseframe")[0]&&0==$(".ls_chooseframe").find(t.target).length&&$(".ls_chooseframe").css("right","-100px")});var h=document.documentElement.clientHeight-370,l=70*$(".ls_chooseframe .framestylebox2 span").length+15;if(l<=h)$(".ls_chooseframe .choosebox").css("height",l+"px");else{$(".ls_chooseframe .choosebox").css("height",h+"px");var g=h-l,f=0,u=function(){f>0?(f=0,$(".ls_chooseframe .choosebox .upmorebtn").hide(),$(".ls_chooseframe .choosebox .downmorebtn").show()):f<=g?(f=g,$(".ls_chooseframe .choosebox .downmorebtn").hide(),$(".ls_chooseframe .choosebox .upmorebtn").show()):($(".ls_chooseframe .choosebox .downmorebtn").show(),$(".ls_chooseframe .choosebox .upmorebtn").show())};$(".ls_chooseframe .choosebox .downmorebtn").show().click(function(){f-=210,u(),$(".framestylebox2").css("margin-top",f+"px")}),$(".ls_chooseframe .choosebox .upmorebtn").click(function(){f+=210,u(),$(".framestylebox2").css("margin-top",f+"px")}),$(".framestylebox2")[0].onmousedown=function(t){var e=$(this),t=t||event,i=t.clientY;return document.onmousemove=function(t){var t=t||event,o=t.clientY;f=f+o-i,u(),e.css("margin-top",f+"px")},document.onmouseup=function(){document.onmousemove=document.onmouseup=null},!1}}}}()});
//# sourceMappingURL=../../map/script/page/Goods.Detail.min.js.map
